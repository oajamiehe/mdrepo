---
العنوان: أفضل الممارسات من أجل تكامل
---

# أفضل الممارسات من أجل تكامل

المهتمة في التكامل مع منصة جيثب؟[كنت في شركة جيدة](https://github.com/integrations). سوف يساعدك هذا الدليل بناء التطبيق الذي يوفر أفضل تجربة للمستخدمين*)؛ و*تأكد من انها تتفاعل بشكل موثوق مع API.

{:toc}

## الحمولات آمنة تسليمها من جيثب

من المهم جدا أن تأمين[والحمولات المرسلة من جيثب][event-types]. على الرغم من أن أية معلومات شخصية (مثل كلمات السر) ينتقل من أي وقت مضى في الحمولة، بتسريب*أي*المعلومات ليست جيدة. بعض المعلومات التي قد تكون حساسة تتضمن عنوان البريد الإلكتروني مرتكب أو أسماء مستودعات خاصة.

هناك ثلاث خطوات يمكنك اتخاذها لضمان استلام الحمولات التي ألقاها جيثب:

1. تأكد من أن الخادم المتلقي الخاص بك هو على اتصال HTTPS. افتراضيا، سوف جيثب التحقق من شهادات SSL عند تسليم الحمولات.
2. يمكنك القائمة البيضاء[عنوان IP التي نستخدمها عند تسليم السنانير](https://help.github.com/articles/what-ip-addresses-does-github-use-that-i-should-whitelist)على الخادم الخاص بك. للتأكد من أنك كنت دائما التحقق من عنوان IP الصحيح، يمكنك[استخدام `/ meta` نقطة النهاية](/v3/meta/#meta)للعثور على عنوان نستخدمها.
3. تزود[عربون السري](/webhooks/securing/)لضمان الحمولات تأتي بالتأكيد من جيثب. من خلال فرض عربون السري، كنت ضمان أن أي بيانات من قبل خادم تلقى قادم تماما من جيثب. من الناحية المثالية، يجب توفير رمز سري مختلفة*لكل مستخدم*الخدمة الخاص بك. بهذه الطريقة، إذا تم المساس رمز واحد، أي مستخدم آخر ستتأثر.

## يفضل عمل غير متزامن عبر متزامن

جيثب تتوقع أن التكامل الرد في غضون ثلاثين ثانية من تلقي حمولة webhook. إذا خدمتكم وقتا أطول من ذلك لإكمال، ثم جيثب إنهاء الاتصال، ويتم فقدان الحمولة.

وبما أنه من المستحيل التنبؤ بكيفية سريعة ستكمل الخدمة الخاص بك، يجب عليك أن تفعل كل "العمل الحقيقي" في وظيفة الخلفية.[Resque](https://github.com/resque/resque/)(لروبي)،[RQ](http://python-rq.org/)(لبيثون)، أو[RabbitMQ](http://www.rabbitmq.com/)(جافا) هي أمثلة على المكتبات التي يمكن التعامل مع الطابور وتجهيز وظائف أساسية.

لاحظ أنه حتى مع تشغيل وظيفة الخلفية، جيثب لا يزال يتوقع الخادم الخاص بك للرد في غضون ثلاثين ثانية. تحتاج الخادم الخاص بك ببساطة أن نعترف أنها تلقت الحمولة عن طريق إرسال نوعا من الاستجابة. فمن الأهمية بمكان أن الخدمة لينفذ أي إثبات على الحمولة في أقرب وقت ممكن، بحيث يمكنك الإبلاغ بدقة ما إذا كان سيستمر الخادم الخاص بك مع هذا الطلب أم لا.

## استخدام رموز حالة HTTP المناسبة عند الرد على جيثب

كل webhook لديها قسم خاص بها "التسليم الأخيرة"، الذي يسرد ما إذا كان نشر ناجحة أم لا.

![عرض تسليم الأخيرة](/assets/images/webhooks_recent_deliveries.png)

يجب الاستفادة من رموز حالة HTTP المناسبة لإطلاع المستخدمين. يمكنك استخدام رموز مثل `201` أو` 202` بتسلم الحمولة التي لا يمكن معالجتها (على سبيل المثال، حمولة تسليمها من قبل فرع وهذا ليس الافتراضي). نحتفظ `كود 500` الخطأ الفشل الكارثي.

## توفير أكبر قدر ممكن من المعلومات للمستخدم

يمكن للمستخدمين حفر في استجابات ملقم أنت ترسل إلى الخلف إلى جيثب. تأكد من أن رسائلك واضحة وغنية بالمعلومات.

![عرض استجابة الحمولة](/assets/images/payload_response_tab.png)

## متابعة الموجهات أن API يرسل لك

جيثب هو واضح في أقول لك عندما انتقلت مورد من خلال توفير رمز حالة إعادة التوجيه. يجب عليك اتباع هذه إعادة التوجيه. كل توجيه استجابة يحدد `رأس Location` مع أوري جديد للذهاب الى. إذا كنت تتلقى إعادة توجيه، فمن الأفضل لتحديث التعليمات البرمجية لمتابعة URI الجديد، في حال كنت طالبا مسار إهمال أننا قد إزالته.

وفرناه[قائمة رموز حالة HTTP](/v3/#http-redirects)لمشاهدة لعند تصميم التطبيق الخاص بك لمتابعة الموجهات.

## لا تحليل عناوين المواقع يدويا

في كثير من الأحيان، والاستجابات API تحتوي على البيانات في شكل عناوين URL. على سبيل المثال، عندما طلب مستودع، سنرسل مفتاح يسمى `clone_url` مع URL يمكنك استخدامها لاستنساخ مستودع.

لاستقرار التطبيق الخاص بك، يجب أن لا محاولة تحليل هذه البيانات أو محاولة تخمين وبناء شكل من عناوين المواقع في المستقبل. التطبيق الخاص بك هو عرضة للكسر إذا قررنا تغيير عنوان URL.

على سبيل المثال، عند العمل مع النتائج مقسمة إلى صفحات، فإنه في كثير من الأحيان مغريا <number> لبناء عناوين URL التي إلحاق `؟ الصفحة =` حتى النهاية. تجنب هذا الإغراء.[دليلنا على ترقيم الصفحات](/guides/traversing-with-pagination)تقدم بعض النصائح آمنة على بعد يعول النتائج مقسمة إلى صفحات.

## تحقق من نوع الحدث والعمل قبل معالجة الحدث

هناك عدة[أنواع الأحداث webhook][event-types]وكل حدث يمكن أن يكون لها إجراءات متعددة. كما ينمو مجموعة ميزة جيثب، وسوف نضيف بعض الأحيان أنواع الأحداث الجديدة أو إضافة إجراءات جديدة لأنواع الأحداث الحالية. تأكد من أن التطبيق الخاص بك يتحقق بشكل واضح نوع وعمل حدث قبل القيام بأي معالجة webhook. و`X-جيثب-Event` طلب رأس يمكن استخدامها لمعرفة هذه الحالة وقد وردت حتى يمكن التعامل معها أن معالجة بشكل مناسب. وبالمثل، فإن حمولة لها على مستوى عال `action` المفتاح الذي يمكن استخدامه لمعرفة أي الإجراءات التي اتخذت على الكائن ذات الصلة.

على سبيل المثال، إذا قمت بتكوين جيثب webhook إلى "أرسل لي**كل شىء**"، وسوف تبدأ طلبك تلقي أنواع الأحداث الجديدة والاجراءات التي يتم إضافتها. ولذلك فمن**لا ينصح لاستخدام أي نوع من التقاط كل بند آخر**. خذ مثال التعليمة البرمجية التالية:

`` `روبي # غير موصى بها: أ-كل الصيد بند آخر يحصل مواطنه EVENT_TYPE ["X-GitHub-Event"] = request.headers حمولة = حالة request.body EVENT_TYPE عندما" مستودع "process_repository (الحمولة) عندما" القضايا "process_issues (حمولة) process_pull_requests آخر ينتهي نهاية` ` `
في هذا المثال رمز، و`process_repository` و` أساليب process_issues` سوف يطلق بشكل صحيح إذا تم تلقي `` repository` أو الحدث issues`. ومع ذلك، فإن أي نوع حدث آخر يؤدي إلى `process_pull_requests` يتم استدعاء. كما يتم إضافة أنواع الأحداث الجديدة، وهذا يؤدي إلى أن تتم معالجة السلوك غير صحيح وأنواع الأحداث الجديدة بنفس الطريقة التي `الحدث pull_request` أن تتم معالجتها.

بدلا من ذلك، فإننا نقترح فحص صراحة أنواع الأحداث والتصرف وفقا لذلك. في مثال التعليمة البرمجية التالية، ونحن تحقق صراحة ل`الحدث pull_request` و` بند else` بتسجيل ببساطة أننا تلقينا نوع الحدث الجديد:

`` `روبي # الموصى بها: تحقق صراحة اكتب كل حدث مواطنه تلقي EVENT_TYPE ["X-GitHub-Event"] = request.headers حمولة = JSON.parse (request.body) حالة EVENT_TYPE عندما" مستودع "process_repository (الحمولة) عندما" القضايا "process_issue (الحمولة) عندما" pull_request "process_pull_requests (حمولة) آخر يضع" أووه، {event_type} شيئا جديدا من جيثب: # "نهاية نهاية` ``
لأن كل حدث يمكن أن يكون لها أيضا إجراءات متعددة، وينصح أن يتم فحص إجراءات مماثلة. على سبيل المثال،[`IssuesEvent`](https://developer.github.com/v3/activity/events/types/#issuesevent)لديها العديد من الإجراءات التي يمكن اتخاذها. وتشمل هذه `opened` عندما يتم إنشاء هذه المسألة،` closed` عندما يتم إغلاق القضية، و`assigned` عندما يتم تعيين قضية لشخص ما.

كما هو الحال مع إضافة أنواع الحدث، قد نضيف إجراءات جديدة للأحداث الحالية. ولذلك فمن مرة أخرى**لا ينصح لاستخدام أي نوع من التقاط كل بند آخر**عند التدقيق العمل على الحدث. بدلا من ذلك، فإننا نقترح فحص صراحة الإجراءات الحدث كما فعلنا مع نوع الحدث. مثال على هذا يشبه الى حد بعيد ما اقترحنا لأنواع الحدث أعلاه:

`` `روبي # الموصى بها: تحقق صراحة كل عمل مواطنه process_issue ["action"] (حمولة) حالة الحمولة عند" فتح "process_issue_opened (الحمولة) عندما" تعيين "process_issue_assigned (الحمولة) عندما" مغلقة "process_issue_closed (حمولة) آخر يضع" أووه، {payload["action"]} شيئا جديدا من جيثب: # "نهاية نهاية` ``
في هذا المثال يتم فحص `عمل closed` أولا قبل استدعاء` طريقة process_closed`. يتم تسجيل أي إجراءات مجهولة الهوية للرجوع إليها في المستقبل.

{% if page.version == 'dotcom' %}

## التعامل مع حدود معدل

وAPI جيثب[حدود التقييم](/v3/#rate-limiting)يضمن API هو سريع ومتاحة للجميع.

إذا كنت أصاب الحد المعدل، من المتوقع أن تقوم تتراجع عن تقديم طلبات صنع وحاول مرة أخرى في وقت لاحق عندما كنت يسمح لهم بذلك. قد يؤدي عدم القيام بذلك سيؤدي في حظر التطبيق الخاص بك.

يمكنك دائما[تحقق معدل وضع الحد الخاص بك](/v3/rate_limit/)في أي وقت. التحقق من الحد معدل حسابك تتحمل أي تكلفة على حد معدل حسابك.

## التعامل مع حدود معدل تعاطي

[حدود معدل تعاطي](/v3/#abuse-rate-limits)هي وسيلة أخرى علينا أن نضمن توافر والمعهد. لتجنب ضرب هذا الحد، يجب عليك التأكد من التطبيق الخاص بك يتبع المبادئ التوجيهية الواردة أدناه.

* تقديم طلبات موثقة، أو استخدام معرف العميل التطبيق الخاص بك والكتمان. طلبات غير مصادق تخضع لمعدل تعاطي أكثر عدوانية الحد.
* تقديم طلبات لمستخدم واحد أو هوية العميل متسلسل. لا تجعل طلبات لمستخدم واحد أو هوية العميل بشكل متزامن.
* إذا كنت تريد أن تجعل عددا كبيرا من `POST`،` PATCH`، `PUT`، أو` طلبات DELETE` لمستخدم واحد أو هوية العميل، والثانية تنتظر واحدة على الأقل بين كل طلب.
* الطلبات التي خلق المحتوى الذي يطلق الإخطارات، مثل قضايا والتعليقات وسحب طلبات، قد يكون أبعد محدودة. يرجى إنشاء هذا المحتوى بوتيرة معقولة لتفادي مزيد من الحد.
* عندما يكون لديك كان محدودا، وانتظر عدد الثواني المحددة في `رأس استجابة إعادة المحاولة، After`.

نحن نحتفظ بالحق في تغيير هذه المبادئ التوجيهية حسب الحاجة لضمان توافر.

{% endif %}

## التعامل مع الأخطاء API

على الرغم من التعليمات البرمجية لن أعرض خلل، قد تجد أن كنت قد واجهت أخطاء متتالية عند محاولة الوصول إلى API.

بدلا من تجاهل المتكررة `4xx` و` رموز الحالة 5xx`، يجب عليك التأكد من أنك التفاعل بشكل صحيح مع API. على سبيل المثال، إذا تطلب نقطة نهاية سلسلة وكنت تمريرها قيمة رقمية، وأنت تسير في الحصول على `خطأ التحقق من صحة 5xx`، وسوف مكالمتك لا تنجح. وبالمثل، في محاولة للوصول إلى نقطة النهاية غير مصرح بها أو غير موجودة سيؤدي إلى `الخطأ 4xx`.

قد يؤدي تجاهل عمدا أخطاء التحقق من صحة المتكررة في تعليق تطبيقك لسوء المعاملة.

[، أنواع الأحداث]: /v3/activity/events/types/
